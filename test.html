<!doctype html>
<meta charset="utf-8">
<title>GAS 一鍵 Submit（form-urlencoded, no fetch）</title>

<!-- 修改成你的 Web App /exec -->
<form id="f" method="POST" action="https://script.google.com/macros/s/AKfycbw1jdsG18FEoO2x-CgkOUXdFIpotUy3xJsJQBKf-FKuFQyKt2DLqLShtBuxNwoOjynj/exec">
  <input type="hidden" name="action" value="submit">
  <input type="hidden" name="key"   id="key">
  <input type="hidden" name="date"  id="date">
  <input type="hidden" name="id"    id="id">     <!-- 小寫 id -->
  <input type="hidden" name="shift" value="中">
  <input type="hidden" name="dN"    value="2">
  <button type="button" id="go">一鍵送出</button>
</form>

<script>
const TZ="Asia/Taipei";

function genID(){
  const CH="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
  let s=""; for(let i=0;i<5;i++) s+=CH[Math.random()*CH.length|0];
  return s;
}
function mmddRule(){
  const now=new Date();
  const h=parseInt(new Intl.DateTimeFormat('zh-Hant-TW',{timeZone:TZ,hour:'2-digit'}).format(now),10);
  const base=new Date(now); if(h>=1) base.setDate(base.getDate()+1);
  const p=new Intl.DateTimeFormat('zh-Hant-TW',{timeZone:TZ,month:'2-digit',day:'2-digit'})
            .formatToParts(base).reduce((a,b)=>(a[b.type]=b.value,a),{});
  return `${p.month}${p.day}`;
}

document.getElementById('go').onclick = ()=>{
  const id = genID();
  const date = mmddRule();
  document.getElementById('id').value = id;
  document.getElementById('date').value = date;
  document.getElementById('key').value = `${date}|${id}`;
  document.getElementById('f').submit();   // 表單直送，Content-Type 由瀏覽器自動設為 x-www-form-urlencoded
};
</script>
```0